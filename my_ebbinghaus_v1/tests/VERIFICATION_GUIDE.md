# 艾宾浩斯遗忘曲线验证指南

## 🎯 验证目标
确保艾宾浩斯遗忘曲线功能正确工作，明天打开复习时能看到应该复习的知识点。

## 📋 验证步骤

### 1. 基础功能验证
访问 `tests/verify_ebbinghaus.html` 进行完整的功能测试：

```bash
# 启动服务器
python -m http.server 8000

# 访问验证页面
http://localhost:8000/tests/verify_ebbinghaus.html
```

### 2. 明天复习验证
访问 `tests/test_tomorrow_review.html` 进行明天复习的模拟测试：

```bash
# 访问明天复习验证页面
http://localhost:8000/tests/test_tomorrow_review.html
```

## 🔍 手动验证方法

### 步骤1：创建测试知识点
1. 打开主应用 `index.html`
2. 添加3个测试知识点：
   - **知识点A**：掌握程度设为"困难"，内容为"今天需要复习"
   - **知识点B**：掌握程度设为"学习中"，内容为"明天需要复习"  
   - **知识点C**：掌握程度设为"掌握"，内容为"后天需要复习"

### 步骤2：验证今天复习
1. 点击"开始复习"按钮
2. 应该只看到"知识点A"（困难等级，当天复习）
3. 完成复习后，标记为"复习成功"

### 步骤3：验证复习间隔计算
复习成功后，系统应该：
- **困难** → **学习中**：下次复习时间应该是明天
- **学习中** → **学习中**：下次复习时间应该是后天
- **掌握** → **掌握**：下次复习时间应该是后天

### 步骤4：验证明天复习
1. 修改系统时间到明天（或等待到明天）
2. 重新打开应用
3. 点击"开始复习"
4. 应该看到需要复习的知识点

## 🧪 自动化验证

### 验证脚本功能
```javascript
// 1. 测试基础算法
function testBasicAlgorithm() {
    // 测试不同掌握程度的间隔计算
    const struggling = calculateNextReviewDate('struggling', '2025-01-01', 0);
    const learning = calculateNextReviewDate('learning', '2025-01-01', 0);
    const mastered = calculateNextReviewDate('mastered', '2025-01-01', 0);
    
    console.log('困难等级间隔:', struggling); // 应该是当天
    console.log('学习中等级间隔:', learning);   // 应该是明天
    console.log('掌握等级间隔:', mastered);     // 应该是明天
}

// 2. 测试复习队列
function testReviewQueue() {
    const pointsToReview = getPointsToReview();
    console.log('今天需要复习的知识点:', pointsToReview.length);
}

// 3. 测试时间计算
function testTimeCalculation() {
    const today = getTodayString();
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    const tomorrowStr = tomorrow.toISOString().split('T')[0];
    
    console.log('今天:', today);
    console.log('明天:', tomorrowStr);
}
```

## 📊 验证检查点

### ✅ 必须通过的检查
1. **算法正确性**：不同掌握程度的复习间隔计算正确
2. **时间计算**：日期加减计算准确
3. **数据持久化**：知识点数据正确保存和加载
4. **复习队列**：能正确识别需要复习的知识点
5. **状态更新**：复习后状态正确更新

### 🔍 详细验证项目

#### 1. 掌握程度间隔验证
| 掌握程度 | 第0次复习 | 第1次复习 | 第2次复习 | 第3次复习 | 第4次复习 |
|----------|-----------|-----------|-----------|-----------|-----------|
| 困难     | 当天      | 1天       | 2天       | 4天       | 8天       |
| 学习中   | 1天       | 2天       | 4天       | 8天       | 16天      |
| 掌握     | 1天       | 3天       | 7天       | 15天      | 30天      |

#### 2. 复习结果处理验证
- **复习成功**：保持或提升掌握程度
- **复习失败**：降低掌握程度
- **跳过**：不改变掌握程度

#### 3. 数据一致性验证
- 知识点创建后立即出现在复习队列中（如果是困难等级）
- 复习后状态正确更新
- 下次复习时间正确计算

## 🚨 常见问题排查

### 问题1：明天看不到需要复习的知识点
**可能原因**：
- 知识点掌握程度设置错误
- 复习时间计算错误
- 数据没有正确保存

**解决方法**：
1. 检查知识点的掌握程度设置
2. 验证 `nextReview` 字段是否正确
3. 检查 `getPointsToReview()` 函数逻辑

### 问题2：复习间隔计算错误
**可能原因**：
- 日期计算逻辑错误
- 掌握程度映射错误

**解决方法**：
1. 检查 `calculateNextReviewDate` 函数
2. 验证 `REVIEW_INTERVALS` 配置
3. 测试日期加减逻辑

### 问题3：数据丢失
**可能原因**：
- localStorage 被清除
- 数据格式错误

**解决方法**：
1. 检查浏览器控制台错误
2. 验证数据格式
3. 重新创建知识点

## 📝 验证报告模板

```
验证日期：____
验证人员：____

✅ 基础功能测试
- [ ] 算法计算正确
- [ ] 时间计算准确
- [ ] 数据持久化正常

✅ 复习流程测试
- [ ] 今天复习队列正确
- [ ] 明天复习队列正确
- [ ] 复习后状态更新正确

✅ 边界情况测试
- [ ] 空数据情况
- [ ] 异常数据情况
- [ ] 网络断开情况

总体结果：通过/不通过
备注：____
```

## 🎯 验证成功标准

验证成功的标准是：
1. **今天**：能看到需要复习的知识点（困难等级）
2. **明天**：能看到需要复习的知识点（学习中等级）
3. **后天**：能看到需要复习的知识点（掌握等级）
4. **复习后**：状态正确更新，下次复习时间正确计算

如果以上所有条件都满足，说明艾宾浩斯遗忘曲线功能正常工作！
